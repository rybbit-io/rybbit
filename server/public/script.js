"use strict";(()=>{var W,nt=-1,E=function(t){addEventListener("pageshow",function(e){e.persisted&&(nt=e.timeStamp,t(e))},!0)},H=function(){return window.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},R=function(){var t=H();return t&&t.activationStart||0},h=function(t,e){var r=H(),o="navigate";return nt>=0?o="back-forward-cache":r&&(document.prerendering||R()>0?o="prerender":document.wasDiscarded?o="restore":r.type&&(o=r.type.replace(/_/g,"-"))),{name:t,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v3-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:o}},L=function(t,e,r){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var o=new PerformanceObserver(function(i){Promise.resolve().then(function(){e(i.getEntries())})});return o.observe(Object.assign({type:t,buffered:!0},r||{})),o}}catch{}},v=function(t,e,r,o){var i,c;return function(d){e.value>=0&&(d||o)&&((c=e.value-(i||0))||i===void 0)&&(i=e.value,e.delta=c,e.rating=function(f,l){return f>l[1]?"poor":f>l[0]?"needs-improvement":"good"}(e.value,r),t(e))}},V=function(t){requestAnimationFrame(function(){return requestAnimationFrame(function(){return t()})})},K=function(t){var e=function(r){r.type!=="pagehide"&&document.visibilityState!=="hidden"||t(r)};addEventListener("visibilitychange",e,!0),addEventListener("pagehide",e,!0)},rt=function(t){var e=!1;return function(r){e||(t(r),e=!0)}},w=-1,$=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},O=function(t){document.visibilityState==="hidden"&&w>-1&&(w=t.type==="visibilitychange"?t.timeStamp:0,ht())},z=function(){addEventListener("visibilitychange",O,!0),addEventListener("prerenderingchange",O,!0)},ht=function(){removeEventListener("visibilitychange",O,!0),removeEventListener("prerenderingchange",O,!0)},it=function(){return w<0&&(w=$(),z(),E(function(){setTimeout(function(){w=$(),z()},0)})),{get firstHiddenTime(){return w}}},M=function(t){document.prerendering?addEventListener("prerenderingchange",function(){return t()},!0):t()},Y=[1800,3e3],q=function(t,e){e=e||{},M(function(){var r,o=it(),i=h("FCP"),c=L("paint",function(d){d.forEach(function(f){f.name==="first-contentful-paint"&&(c.disconnect(),f.startTime<o.firstHiddenTime&&(i.value=Math.max(f.startTime-R(),0),i.entries.push(f),r(!0)))})});c&&(r=v(t,i,Y,e.reportAllChanges),E(function(d){i=h("FCP"),r=v(t,i,Y,e.reportAllChanges),V(function(){i.value=performance.now()-d.timeStamp,r(!0)})}))})},G=[.1,.25],at=function(t,e){e=e||{},q(rt(function(){var r,o=h("CLS",0),i=0,c=[],d=function(l){l.forEach(function(u){if(!u.hadRecentInput){var p=c[0],S=c[c.length-1];i&&u.startTime-S.startTime<1e3&&u.startTime-p.startTime<5e3?(i+=u.value,c.push(u)):(i=u.value,c=[u])}}),i>o.value&&(o.value=i,o.entries=c,r())},f=L("layout-shift",d);f&&(r=v(t,o,G,e.reportAllChanges),K(function(){d(f.takeRecords()),r(!0)}),E(function(){i=0,o=h("CLS",0),r=v(t,o,G,e.reportAllChanges),V(function(){return r()})}),setTimeout(r,0))}))};var ot=0,F=1/0,D=0,vt=function(t){t.forEach(function(e){e.interactionId&&(F=Math.min(F,e.interactionId),D=Math.max(D,e.interactionId),ot=D?(D-F)/7+1:0)})},st=function(){return W?ot:performance.interactionCount||0},yt=function(){"interactionCount"in performance||W||(W=L("event",vt,{type:"event",buffered:!0,durationThreshold:0}))},Q=[200,500],ct=0,X=function(){return st()-ct},m=[],B={},Z=function(t){var e=m[m.length-1],r=B[t.interactionId];if(r||m.length<10||t.duration>e.latency){if(r)r.entries.push(t),r.latency=Math.max(r.latency,t.duration);else{var o={id:t.interactionId,latency:t.duration,entries:[t]};B[o.id]=o,m.push(o)}m.sort(function(i,c){return c.latency-i.latency}),m.splice(10).forEach(function(i){delete B[i.id]})}},ut=function(t,e){e=e||{},M(function(){var r;yt();var o,i=h("INP"),c=function(f){f.forEach(function(p){p.interactionId&&Z(p),p.entryType==="first-input"&&!m.some(function(S){return S.entries.some(function(k){return p.duration===k.duration&&p.startTime===k.startTime})})&&Z(p)});var l,u=(l=Math.min(m.length-1,Math.floor(X()/50)),m[l]);u&&u.latency!==i.value&&(i.value=u.latency,i.entries=u.entries,o())},d=L("event",c,{durationThreshold:(r=e.durationThreshold)!==null&&r!==void 0?r:40});o=v(t,i,Q,e.reportAllChanges),d&&("PerformanceEventTiming"in window&&"interactionId"in PerformanceEventTiming.prototype&&d.observe({type:"first-input",buffered:!0}),K(function(){c(d.takeRecords()),i.value<0&&X()>0&&(i.value=0,i.entries=[]),o(!0)}),E(function(){m=[],ct=st(),i=h("INP"),o=v(t,i,Q,e.reportAllChanges)}))})},tt=[2500,4e3],U={},lt=function(t,e){e=e||{},M(function(){var r,o=it(),i=h("LCP"),c=function(l){var u=l[l.length-1];u&&u.startTime<o.firstHiddenTime&&(i.value=Math.max(u.startTime-R(),0),i.entries=[u],r())},d=L("largest-contentful-paint",c);if(d){r=v(t,i,tt,e.reportAllChanges);var f=rt(function(){U[i.id]||(c(d.takeRecords()),d.disconnect(),U[i.id]=!0,r(!0))});["keydown","click"].forEach(function(l){addEventListener(l,function(){return setTimeout(f,0)},!0)}),K(f),E(function(l){i=h("LCP"),r=v(t,i,tt,e.reportAllChanges),V(function(){i.value=performance.now()-l.timeStamp,U[i.id]=!0,r(!0)})})}})},et=[800,1800],bt=function t(e){document.prerendering?M(function(){return t(e)}):document.readyState!=="complete"?addEventListener("load",function(){return t(e)},!0):setTimeout(e,0)},dt=function(t,e){e=e||{};var r=h("TTFB"),o=v(t,r,et,e.reportAllChanges);bt(function(){var i=H();if(i){var c=i.responseStart;if(c<=0||c>performance.now())return;r.value=Math.max(c-R(),0),r.entries=[i],o(!0),E(function(){r=h("TTFB",0),(o=v(t,r,et,e.reportAllChanges))(!0)})}})};(function(){let t=document.currentScript,e=t?.getAttribute("src")?.split("/script.js")[0];if(window.__RYBBIT_OPTOUT__||localStorage.getItem("disable-rybbit")!==null){window.rybbit={pageview:()=>{},event:()=>{},trackOutbound:()=>{},identify:()=>{},clearUserId:()=>{},getUserId:()=>null};return}if(!e){console.error("Please provide a valid analytics host");return}let r=t.getAttribute("data-site-id")||t.getAttribute("site-id");if(!r||isNaN(Number(r))){console.error("Please provide a valid site ID using the data-site-id attribute");return}let o=t.getAttribute("data-debounce")?Math.max(0,parseInt(t.getAttribute("data-debounce")||"0")):500,i=t.getAttribute("data-auto-track-pageview")!=="false",c=t.getAttribute("data-track-spa")!=="false",d=t.getAttribute("data-track-query")!=="false",f=t.getAttribute("data-track-outbound")!=="false",l=[];try{let n=t.getAttribute("data-skip-patterns");n&&(l=JSON.parse(n),Array.isArray(l)||(l=[]))}catch(n){console.error("Error parsing data-skip-patterns:",n)}let u=[];try{let n=t.getAttribute("data-mask-patterns");n&&(u=JSON.parse(n),Array.isArray(u)||(u=[]))}catch(n){console.error("Error parsing data-mask-patterns:",n)}let p=null;try{let n=localStorage.getItem("rybbit-user-id");n&&(p=n)}catch{}function S(n){let a="__DOUBLE_ASTERISK_TOKEN__",s="__SINGLE_ASTERISK_TOKEN__",y=n.replace(/\*\*/g,a).replace(/\*/g,s).replace(/[.+?^${}()|[\]\\]/g,"\\$&");y=y.replace(/\//g,"\\/");let x=y.replace(new RegExp(a,"g"),".*").replace(new RegExp(s,"g"),"[^/]+");return new RegExp("^"+x+"$")}function k(n,a){for(let s of a)try{if(S(s).test(n))return s}catch(g){console.error(`Invalid pattern: ${s}`,g)}return null}function ft(n,a){let s;return(...g)=>{clearTimeout(s),s=setTimeout(()=>n.apply(this,g),a)}}function pt(n){try{let a=window.location.hostname,s=new URL(n).hostname;return s!==a&&s!==""}catch{return!1}}let j=()=>{let n=new URL(window.location.href),a=n.pathname;if(n.hash&&n.hash.startsWith("#/")&&(a=n.hash.substring(1)),k(a,l))return null;let s=k(a,u);s&&(a=s);let g={site_id:r,hostname:n.hostname,pathname:a,querystring:d?n.search:"",screenWidth:window.innerWidth,screenHeight:window.innerHeight,language:navigator.language,page_title:document.title,referrer:document.referrer};return p&&(g.user_id=p),g},J=n=>{fetch(`${e}/track`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),mode:"cors",keepalive:!0}).catch(console.error)},I=(n="pageview",a="",s={})=>{if(n==="custom_event"&&(!a||typeof a!="string")){console.error("Event name is required and must be a string for custom events");return}let g=j();if(!g)return;let y={...g,type:n,event_name:a,properties:n==="custom_event"||n==="outbound"?JSON.stringify(s):void 0};J(y)},b={lcp:null,cls:null,inp:null,fcp:null,ttfb:null},T=!1,C=null,gt=()=>{if(T)return;Object.values(b).every(a=>a!==null)&&N()},N=()=>{if(T)return;T=!0,C&&(clearTimeout(C),C=null);let n=j();if(!n)return;let a={...n,type:"performance",event_name:"web-vitals",lcp:b.lcp,cls:b.cls,inp:b.inp,fcp:b.fcp,ttfb:b.ttfb};J(a)},P=n=>{T||(b[n.name.toLowerCase()]=n.value,gt())},mt=()=>{try{lt(P),at(P),ut(P),q(P),dt(P),C=setTimeout(()=>{T||N()},2e4),window.addEventListener("beforeunload",()=>{T||N()})}catch(n){console.warn("Error initializing web vitals tracking:",n)}},A=()=>I("pageview"),_=o>0?ft(A,o):A;if(document.addEventListener("click",function(n){let a=n.target;for(;a&&a instanceof HTMLElement&&a!==document.documentElement;){if(a.hasAttribute("data-rybbit-event")){let s=a.getAttribute("data-rybbit-event");if(s){let g={};for(let y of a.attributes)if(y.name.startsWith("data-rybbit-prop-")){let x=y.name.replace("data-rybbit-prop-","");g[x]=y.value}I("custom_event",s,g)}break}a=a.parentElement}if(f){let s=n.target&&n.target instanceof HTMLElement?n.target.closest("a"):null;if(!s||!s.href)return;pt(s.href)&&I("outbound","",{url:s.href,text:s.innerText||s.textContent||"",target:s.target||"_self"})}}),c){let n=history.pushState,a=history.replaceState;history.pushState=function(...s){n.apply(this,s),_()},history.replaceState=function(...s){a.apply(this,s),_()},window.addEventListener("popstate",_),window.addEventListener("hashchange",_)}window.rybbit={pageview:A,event:(n,a={})=>I("custom_event",n,a),trackOutbound:(n,a="",s="_self")=>I("outbound","",{url:n,text:a,target:s}),identify:n=>{if(typeof n!="string"||n.trim()===""){console.error("User ID must be a non-empty string");return}p=n.trim();try{localStorage.setItem("rybbit-user-id",p)}catch{console.warn("Could not persist user ID to localStorage")}},clearUserId:()=>{p=null;try{localStorage.removeItem("rybbit-user-id")}catch{}},getUserId:()=>p},i&&A(),mt()})();})();
